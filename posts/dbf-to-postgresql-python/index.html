<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>From dbf to SQL (and PostgreSQL) with Python | Data and Open Source</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Translate from dbf to SQL with Python">
    <meta name="generator" content="Hugo 0.140.2">
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.d05fb5f317fcf33b3a52936399bdf6f47dc776516e1692e412ec7d76f4a5faa2.css" >




    


    
      

    

    

    
      <link rel="canonical" href="https://ftisiot.net/posts/dbf-to-postgresql-python/">
    

    <meta property="og:url" content="https://ftisiot.net/posts/dbf-to-postgresql-python/">
  <meta property="og:site_name" content="Data and Open Source">
  <meta property="og:title" content="From dbf to SQL (and PostgreSQL) with Python">
  <meta property="og:description" content="Translate from dbf to SQL with Python">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-04T14:31:10+01:00">
    <meta property="article:modified_time" content="2024-03-04T14:31:10+01:00">

  <meta itemprop="name" content="From dbf to SQL (and PostgreSQL) with Python">
  <meta itemprop="description" content="Translate from dbf to SQL with Python">
  <meta itemprop="datePublished" content="2024-03-04T14:31:10+01:00">
  <meta itemprop="dateModified" content="2024-03-04T14:31:10+01:00">
  <meta itemprop="wordCount" content="268">
  <meta itemprop="keywords" content="Dbf,SQL,Python,PostgreSQL">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="From dbf to SQL (and PostgreSQL) with Python">
  <meta name="twitter:description" content="Translate from dbf to SQL with Python">

      
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-7Z74BTZ0TM"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-7Z74BTZ0TM');
        }
      </script>
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

  
  
  
  <header class="cover bg-center" style="background-image: url('https://ftisiot.net/images/2024/dbf-pg.png');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l center items-center justify-between">
    <a href="/" class="f3 fw2 hover-white white-90 dib no-underline">
      
        Data and Open Source
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/who" title="about page">
              about
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/suggestions-verona" title="suggestions page">
              suggestions
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/postgresqljson/main" title="json-pg page">
              json-pg
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white white-90 no-underline" href="/mysqljson/main" title="json-mysql page">
              json-mysql
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">From dbf to SQL (and PostgreSQL) with Python</div>
          
            <div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Translate from dbf to SQL with Python
            </div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l mw8 center ph3 flex-wrap justify-between">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">From dbf to SQL (and PostgreSQL) with Python</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-03-04T14:31:10+01:00">March 4, 2024</time>
      

      
      
        <span class="f6 mv4 dib tracked"> - 2 minutes read </span>
        <span class="f6 mv4 dib tracked"> - 268 words </span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Some time ago I found an interesting database file suffix I never faced before: the <code>.dbf</code> and saw around that it was first introduced in 1983 with dBASE II. This article showcases how we can automatically generate the PostgreSQL table and fill it with data using Python and <a href="https://dbfread.readthedocs.io/en/latest/exporting_data.html#dataset-sql">dbfread</a>.</p>
<h2 id="download-a-sample-dbf-file">Download a sample dbf file</h2>
<p>We can get a sample <code>.dbf</code> file from <a href="https://github.com/infused/dbf/blob/master/spec/fixtures/cp1251.dbf">Infused</a> with the following in our terminal</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://github.com/infused/dbf/raw/master/spec/fixtures/cp1251.dbf
</span></span></code></pre></div><p>This will store a file named <code>cp1251.dbf</code> in the current folder.</p>
<h2 id="use-dbfread-to-move-the-data-into-postgresql">Use dbfread to move the data into PostgreSQL</h2>
<p>We need to install simpledf with</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install dbfread
</span></span></code></pre></div><p>Then we can write a Python script (named <code>convert_bdf_to_sql.py</code>) that opens the <code>sample.dbf</code> file and creates the PostgreSQL DDL and loads the data into a <code>CSV</code> file we can use to populate the database</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">dbfread</span> <span style="color:#008000;font-weight:bold">import</span> DBF
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">dataset</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db <span style="color:#666">=</span> dataset<span style="color:#666">.</span>connect(<span style="color:#ba2121">&#39;postgresql://[USER]:[PWD]@[HOST]:[PORT]/[DBNAME]?sslmode=require&#39;</span>)
</span></span><span style="display:flex;"><span>table <span style="color:#666">=</span> db[<span style="color:#ba2121">&#39;people&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">for</span> record <span style="color:#a2f;font-weight:bold">in</span> DBF(<span style="color:#ba2121">&#39;cp1251.dbf&#39;</span>, lowernames<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>):
</span></span><span style="display:flex;"><span>    table<span style="color:#666">.</span>insert(record)
</span></span></code></pre></div><p>In the above script we:</p>
<ul>
<li>connect to a PostgreSQL instance using
<ul>
<li><code>[USER]</code>: the username</li>
<li><code>[PWD]</code>: the password</li>
<li><code>[HOST]</code>: the hostname</li>
<li><code>[PORT]</code>: the port</li>
<li><code>[DBNAME]</code>: the database name</li>
</ul>
</li>
<li>define a table named <code>people</code> that will be created and populated</li>
<li>insert into the <code>people</code> table all the records in <code>cp1251.dbf</code></li>
</ul>
<p>We can then execute it with:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python convert_bdf_to_sql.py
</span></span></code></pre></div><p>If we now connect to our PostgreSQL database:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psql postgres://<span style="color:#666">[</span>USER<span style="color:#666">]</span>:<span style="color:#666">[</span>PWD<span style="color:#666">]</span>@<span style="color:#666">[</span>HOST<span style="color:#666">]</span>:<span style="color:#666">[</span>PORT<span style="color:#666">]</span>/<span style="color:#666">[</span>DBNAME<span style="color:#666">]</span>?sslmode<span style="color:#666">=</span>require
</span></span></code></pre></div><p>we can check the <code>people</code> table being populated with:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>people;<span style="color:#bbb">
</span></span></span></code></pre></div><p>We can see the data in the table!</p>
<pre tabindex="0"><code> id | rn |                  name
----+----+----------------------------------------
  1 |  1 | амбулаторно-поликлиническое
  2 |  2 | больничное
  3 |  3 | НИИ
  4 |  4 | образовательное медицинское учреждение
(4 rows)
</code></pre><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href="https://ftisiot.net/" >
    &copy;  Data and Open Source 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
